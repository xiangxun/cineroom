var U=Object.defineProperty;var X=(r,o,t)=>o in r?U(r,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[o]=t;var v=(r,o,t)=>(X(r,typeof o!="symbol"?o+"":o,t),t);import{W as Y,s as J,S as Q,P as Z,G as $,B as j,V as k,a as ee,C as te,L as oe,M as C,b as y,c as F,O as ne,d as D,T as se,R as P,e as ae,A as ie,f as B,g as I,h as x,i as H,j as re,k as ce,l as le,m as de,n as ue,o as pe,r as g,p as me,q as he,t as fe,u as a,F as we,v as ve,w as ye,x as ge,y as _e}from"./vendor.0137f7be.js";const be=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const s of e)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function t(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerpolicy&&(s.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?s.credentials="include":e.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(e){if(e.ep)return;e.ep=!0;const s=t(e);fetch(e.href,s)}};be();var Ee="/video/\u6700\u4F1F\u5927\u7684\u4F5C\u54C1.mp4",W="/audio/\u8BF4\u597D\u4E86\u4E0D\u6563.mp3";class Le{constructor(o){v(this,"dom");v(this,"renderer");v(this,"scene");v(this,"camera");v(this,"raycaster");this.dom=o;const t=new Y({antialias:!0});t.shadowMap.enabled=!0,t.outputEncoding=J;const n=new Q,e=new Z(45,o.offsetWidth/o.offsetHeight,1,1e4);new $().load("gltfModel/cineRoom.glb",p=>{const i=p.scene,w=new j().setFromObject(i).getCenter(new k);i.position.x+=i.position.x-w.x,i.position.y+=i.position.y-w.y,i.position.z+=i.position.z-w.z,console.log("@",p.scene),n.add(i)}),e.position.set(-40,30,7),e.lookAt(new k(0,0,0)),e.up=new k(0,1,0);const d=document.getElementById("video");console.log(d);const c=new ee(d);c.wrapS=c.wrapT=te,c.minFilter=oe;const u=new C({map:c}),l=new y(new F(.01,27,51),u);l.position.set(43,-6,-1.5),n.add(l);const f=new ne(e,t.domElement);f.enableDamping=!0,f.mouseButtons={LEFT:null,MIDDLE:D.PAN,RIGHT:D.ROTATE};const m=new se(e,t.domElement);n.add(m);let _=!1;m.addEventListener("mouseDown",()=>{_=!0});let b;const h=new P,M=new P,E=new ae;t.domElement.addEventListener("mousemove",p=>{E.x=2*(p.clientX/window.innerWidth)-1,E.y=-2*(p.clientY/window.innerHeight)+1});const q=()=>{clearTimeout(b),b=setTimeout(()=>{if(_)return _=!1,!1;console.log("click"),h.setFromCamera(E,e),n.remove(m);const p=h.intersectObjects(n.children);if(p.length){const i=p[0].object;console.log("click",i),n.add(m),m.attach(i)}},300)},K=()=>{clearTimeout(b),M.setFromCamera(E,e),n.remove(m);const p=M.intersectObjects(n.children);if(p.length){const i=p[0].object;e.lookAt(i.position),f.target=i.position;const O=new j().setFromObject(i),w=new re(O);w.raycast=()=>{},n.add(w),console.log(i)}console.log("delclick")};t.domElement.addEventListener("click",q),t.domElement.addEventListener("dblclick",K),o.appendChild(t.domElement),t.setSize(o.offsetWidth,o.offsetHeight),t.render(n,e);const T=()=>{f.update(),requestAnimationFrame(T),t.render(n,e)};T(),window.addEventListener("resize",()=>{e.aspect=window.innerWidth/window.innerHeight,e.updateProjectionMatrix(),t.setSize(window.innerWidth,window.innerHeight),t.setPixelRatio(Math.min(window.devicePixelRatio,2))}),this.raycaster=h,this.renderer=t,this.camera=e,this.scene=n}playMusic(){const o=new ie;this.camera.add(o);const t=document.getElementById("musicL");t.play();const n=new B(o);n.setMediaElementSource(t),n.setRefDistance(100),n.setMaxDistance(120),n.setDirectionalCone(120,230,.1);const e=new I(n,1);e.raycast=()=>{},n.add(e);const s=new y(new x(.5,50,50),new H({color:16777215*Math.random()}));s.position.set(40,-6,-28),s.rotation.y-=Math.PI*1/5,s.add(n),this.scene.add(s);const d=document.getElementById("musicR");d.play();const c=new B(o);c.setMediaElementSource(d),c.setRefDistance(100),c.setMaxDistance(120),c.setDirectionalCone(120,230,.1);const u=new I(c,1);u.raycast=()=>{},c.add(u);const l=new y(new x(.5,50,50),new H({color:16777215*Math.random()}));l.position.set(40,-6,25),l.rotation.y+=Math.PI*5/4,l.add(c),this.scene.add(l)}addObject(...o){o.forEach(t=>{this.scene.add(t)})}}const G=[],z=new y(new F(10,10,10),new C({color:"#ffffaa"}));z.position.y=5;z.castShadow=!0;const Me=new y(new x(5,50,100),new C({}));Me.position.set(20,5,0);const A=new y(new F(500,.1,500),new ce);A.position.y=-25;A.receiveShadow=!0;G.push(A);const N=[],ke=new le(16777215*Math.random(),.1),R=new de(16777215*Math.random(),.2);R.position.set(-25,15,0);R.castShadow=!0;const S=new ue(16777215*Math.random(),10,100,Math.PI/180*10);S.castShadow=!0;S.position.set(-50,30,-1);N.push(ke,R,S);var Ce=(r,o)=>{const t=r.__vccOpts||r;for(const[n,e]of o)t[n]=e;return t};const L=r=>(ve("data-v-77a013f4"),r=r(),ye(),r),Fe={class:"container"},xe=L(()=>a("source",{src:Ee,type:"video/mp4"},null,-1)),Ae=[xe],Re=L(()=>a("source",{src:W,type:"audio/mpeg"},null,-1)),Se=[Re],Te=L(()=>a("source",{src:W,type:"audio/mpeg"},null,-1)),Oe=[Te],je=L(()=>a("p",{class:"tip"},"\u5E26\u4E0A\u8033\u673A\u98DF\u7528\u66F4\u4F73",-1)),De=pe({__name:"App",setup(r){const o=g(),t=g();me(()=>{const h=new Le(o.value);h.addObject(...G),h.addObject(...N),t.value.addEventListener("click",function(){h.playMusic()})});const n=g(),e=()=>{n.value.remove()},s=g(),d=()=>{s.value.play()},c=()=>{s.value.pause()},u=g(),l=g(),f=()=>{u.value.play(),l.value.play()},m=()=>{u.value.pause(),l.value.pause()},_=()=>{u.value.muted==!0?u.value.muted=!1:u.value.muted=!0},b=()=>{l.value.muted==!0?l.value.muted=!1:l.value.muted=!0};return(h,M)=>(he(),fe(we,null,[a("div",{class:"three-canvas",ref_key:"threeTarget",ref:o},null,512),a("div",Fe,[a("video",{id:"video",ref_key:"video",ref:s,controls:"true"},Ae,512),a("audio",{id:"musicL",preload:"auto",ref_key:"musicL",ref:u,loop:"",controls:""},Se,512),a("audio",{id:"musicR",preload:"auto",ref_key:"musicR",ref:l,loop:"",controls:""},Oe,512),a("button",{onClick:d,class:"play"},"\u64AD\u653E\u89C6\u9891"),a("button",{onClick:c,class:"pause"},"\u89C6\u9891\u6682\u505C"),a("button",{onClick:f},"\u64AD\u653E\u97F3\u4E50"),a("button",{onClick:m},"\u97F3\u4E50\u6682\u505C"),a("button",{onClick:_},"\u5DE6\u97F3\u54CD\u9759\u97F3"),a("button",{onClick:b},"\u53F3\u97F3\u54CD\u9759\u97F3")]),a("div",{class:"overlay",ref_key:"overlay",ref:n},[a("button",{onClick:e,ref_key:"start",ref:t},"Enter",512),je],512)],64))}});var Pe=Ce(De,[["__scopeId","data-v-77a013f4"]]);const V=ge(Pe);V.use(_e());V.mount("#app");
